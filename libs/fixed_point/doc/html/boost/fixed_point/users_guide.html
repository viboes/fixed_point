<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Users' Guide</title>
<link rel="stylesheet" href="../.././boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.76.0">
<link rel="home" href="../../index.html" title="Toward Boost.FixedPoint 0.1.0">
<link rel="up" href="../../index.html" title="Toward Boost.FixedPoint 0.1.0">
<link rel="prev" href="overview.html" title="Overview">
<link rel="next" href="reference.html" title="Reference">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="overview.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../../index.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="reference.html"><img src="../../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost.fixed_point.users_guide"></a><a class="link" href="users_guide.html" title="Users' Guide">Users' Guide</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.getting_started">Getting
      Started</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.getting_started.install">Installing
        FixedPoint</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.getting_started.hello_world__">Hello
        World! </a></span></dt>
</dl></dd>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial">Tutorial</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.basic">Range
        and resolution</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.ope">Initialization
        from an index</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.conversions">Implicit
        conversions</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.ope0">Mixed
        Arithmetic</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.round">Rounding</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.overflow">Overflow</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.literals">Literals</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family">Family</a></span></dt>
</dl></dd>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.examples">Examples</a></span></dt>
<dd><dl><dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.examples.alfa">Alfa blending</a></span></dt></dl></dd>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.ext_references">External
      Resources</a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost.fixed_point.users_guide.getting_started"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started" title="Getting Started">Getting
      Started</a>
</h3></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.getting_started.install">Installing
        FixedPoint</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.getting_started.hello_world__">Hello
        World! </a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.getting_started.install"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.install" title="Installing FixedPoint">Installing
        FixedPoint</a>
</h4></div></div></div>
<h6>
<a name="boost.fixed_point.users_guide.getting_started.install.h0"></a>
          <span><a name="boost.fixed_point.users_guide.getting_started.install.getting_boost_fixedpoint"></a></span><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.install.getting_boost_fixedpoint">Getting
          Boost.FixedPoint</a>
        </h6>
<p>
          You can get the last stable release of Boost.FixedPoint by downloading
          <code class="literal">fixed_point.zip</code> from the
        </p>
<p>
          You can also access the latest (unstable?) state from the <a href="https://svn.boost.org/svn/boost/sandbox/fixed_point" target="_top">Boost
          Sandbox</a>.
        </p>
<h6>
<a name="boost.fixed_point.users_guide.getting_started.install.h1"></a>
          <span><a name="boost.fixed_point.users_guide.getting_started.install.building_boost_fixedpoint"></a></span><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.install.building_boost_fixedpoint">Building
          Boost.FixedPoint</a>
        </h6>
<p>
          There is no need to compile <span class="bold"><strong>Boost.FixedPoint</strong></span>,
          since it's a header only library. Just include your Boost header directory
          in your compiler include path.
        </p>
<h6>
<a name="boost.fixed_point.users_guide.getting_started.install.h2"></a>
          <span><a name="boost.fixed_point.users_guide.getting_started.install.requirements"></a></span><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.install.requirements">Requirements</a>
        </h6>
<p>
          <span class="bold"><strong>Boost.FixedPoint</strong></span> depends on <span class="bold"><strong>Boost.Config</strong></span>, <span class="bold"><strong>Boost.MPL</strong></span>,
          <span class="bold"><strong>Boost.TypeTraits</strong></span>, <span class="bold"><strong>Boost.Assert</strong></span>,
          <span class="bold"><strong>Boost.Integer</strong></span>, <span class="bold"><strong>Boost.Utility/EnableIf</strong></span>,
          <span class="bold"><strong>Boost.Ratio/mpl::abs</strong></span>.
        </p>
<h6>
<a name="boost.fixed_point.users_guide.getting_started.install.h3"></a>
          <span><a name="boost.fixed_point.users_guide.getting_started.install.exceptions_safety"></a></span><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.install.exceptions_safety">Exceptions
          safety</a>
        </h6>
<p>
          All functions in the library are exception-neutral and provide strong guarantee
          of exception safety as long as the underlying parameters provide it.
        </p>
<h6>
<a name="boost.fixed_point.users_guide.getting_started.install.h4"></a>
          <span><a name="boost.fixed_point.users_guide.getting_started.install.thread_safety"></a></span><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.install.thread_safety">Thread
          safety</a>
        </h6>
<p>
          All functions in the library are thread-unsafe except when noted explicitly.
        </p>
<h6>
<a name="boost.fixed_point.users_guide.getting_started.install.h5"></a>
          <span><a name="boost.fixed_point.users_guide.getting_started.install.tested_compilers"></a></span><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.install.tested_compilers">Tested
          compilers</a>
        </h6>
<p>
          <span class="bold"><strong>Boost.FixedPoint</strong></span> is known to work on the
          following platforms/compilers (lack of some C++/C++0X language support
          disables some functionality). The needed C++/C++0X language support is:
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              SFINAE on expressions
            </li></ul></div>
<p>
          Currently, <span class="bold"><strong>Boost.FixedPoint</strong></span> has been tested
          on the following compilers/platforms using the trunk (Boost 1.50):
        </p>
<p>
          Windows with
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
              MSVC 10.0
            </li></ul></div>
<p>
          MinGW with
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              GCC 4.5.0
            </li>
<li class="listitem">
              GCC 4.5.0 -std=c++0x
            </li>
<li class="listitem">
              GCC 4.5.2
            </li>
<li class="listitem">
              GCC 4.5.2 -std=c++0x
            </li>
<li class="listitem">
              GCC 4.6.0
            </li>
<li class="listitem">
              GCC 4.6.0 -std=c++0x
            </li>
<li class="listitem">
              GCC 4.6.3
            </li>
<li class="listitem">
              GCC 4.6.3 -std=c++0x
            </li>
<li class="listitem">
              GCC 4.7.0
            </li>
<li class="listitem">
              GCC 4.7.0 -std=c++0x
            </li>
</ul></div>
<p>
          MacOs X 10.6.8
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              GCC 4.1.2
            </li>
<li class="listitem">
              clang 1.6
            </li>
<li class="listitem">
              clang 2.8
            </li>
<li class="listitem">
              clang 2.9
            </li>
<li class="listitem">
              clang 2.9 -std=c++0x
            </li>
<li class="listitem">
              clang 3.0
            </li>
<li class="listitem">
              clang 3.0 -std=c++0x
            </li>
<li class="listitem">
              darwin 4.6.2
            </li>
<li class="listitem">
              darwin 4.6.2 -std=c++0x
            </li>
<li class="listitem">
              darwin 4.7.0
            </li>
<li class="listitem">
              darwin 4.7.0 -std=c++0x
            </li>
</ul></div>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            Please let us know how this works on other platforms/compilers.
          </p></td></tr>
</table></div>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
            Please send any questions, comments and bug reports to boost &lt;at&gt;
            lists &lt;dot&gt; boost &lt;dot&gt; org.
          </p></td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.getting_started.hello_world__"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.getting_started.hello_world__" title="Hello World!">Hello
        World! </a>
</h4></div></div></div>
<p>
          Here's a very quick illustration of how the class can be used.
        </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">fixed_point</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">using</span> <span class="identifier">namesapce</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">fixed_point</span><span class="special">;</span>
<span class="keyword">void</span> <span class="identifier">test</span><span class="special">()</span>
<span class="special">{</span>
   <span class="identifier">real_t</span><span class="special">&lt;</span><span class="number">15</span><span class="special">,-</span><span class="number">16</span><span class="special">&gt;</span> <span class="identifier">f1</span><span class="special">,</span> <span class="identifier">f2</span><span class="special">;</span>  <span class="comment">// Signed fixed-point values with 15 bits of integer part </span>
                       <span class="comment">// and 16 bits of fractional part.</span>
   <span class="identifier">f1</span> <span class="special">=</span> <span class="identifier">convert</span><span class="special">(</span><span class="number">1.2345</span><span class="special">);</span>   <span class="comment">// Conversion from floating point.</span>
   <span class="identifier">f2</span> <span class="special">=</span> <span class="identifier">convert</span><span class="special">(</span><span class="identifier">f1</span> <span class="special">-</span> <span class="number">2</span><span class="special">);</span>   <span class="comment">// Mixed arithmetic with integers.</span>
   <span class="identifier">f2</span> <span class="special">=</span> <span class="identifier">convert</span><span class="special">(</span><span class="identifier">f1</span> <span class="special">/</span> <span class="identifier">f2</span><span class="special">);</span>  <span class="comment">// Arithmetic on fixed-point values.</span>
<span class="special">}</span>
</pre>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost.fixed_point.users_guide.tutorial"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial" title="Tutorial">Tutorial</a>
</h3></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.basic">Range
        and resolution</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.ope">Initialization
        from an index</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.conversions">Implicit
        conversions</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.ope0">Mixed
        Arithmetic</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.round">Rounding</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.overflow">Overflow</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.literals">Literals</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family">Family</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.closed">Closed
          arithmetic</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.storage">Storage</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.arth">Open
          versus Closed arithmetic</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.bound">Bounded
          versus unbounded fixed points</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv">Conversions</a></span></dt>
</dl></dd>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.basic"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.basic" title="Range and resolution">Range
        and resolution</a>
</h4></div></div></div>
<p>
          The fixed-point library contains two class templates. They are <code class="computeroutput">uint_t</code> and <code class="computeroutput">int_t</code>
          for integer arithmetic, and <code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code>
          and <code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code> for
          fractional arithmetic.
        </p>
<p>
          These types have a range specified by an integer. The range of an unsigned
          number <code class="computeroutput"><span class="identifier">n</span></code> is <code class="computeroutput"><span class="number">0</span> <span class="special">&lt;=</span> <span class="identifier">n</span> <span class="special">&lt;</span> <span class="number">2</span><span class="special">^</span><span class="identifier">g</span></code>
          where <code class="computeroutput"><span class="identifier">g</span></code> is the range parameter.
          The range of an signed number <code class="computeroutput"><span class="identifier">n</span></code>
          is <code class="computeroutput"><span class="number">2</span><span class="special">^</span><span class="identifier">g</span> <span class="special">&lt;</span> <span class="identifier">n</span> <span class="special">&lt;</span> <span class="number">2</span><span class="special">^</span><span class="identifier">g</span></code>.
          Note that the range interval is half-open for unsigned numbers and open
          for signed numbers. For example, <code class="computeroutput">uint_t<span class="special">&lt;</span><span class="number">8</span><span class="special">&gt;</span></code>
          has values <code class="computeroutput"><span class="identifier">n</span></code> such that
          <code class="computeroutput"><span class="number">0</span> <span class="special">&lt;=</span>
          <span class="identifier">n</span> <span class="special">&lt;</span>
          <span class="number">256</span></code> and <code class="computeroutput">int_t<span class="special">&lt;</span><span class="number">8</span><span class="special">&gt;</span></code>
          has values <code class="computeroutput"><span class="identifier">n</span></code> such that
          <code class="computeroutput"><span class="special">-</span><span class="number">256</span>
          <span class="special">&lt;</span> <span class="identifier">n</span>
          <span class="special">&lt;</span> <span class="number">256</span></code>.
        </p>
<pre class="programlisting"><code class="computeroutput">uint_t</code><span class="special">&lt;</span><span class="number">8</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">;</span>
</pre>
<p>
          The fractional types have a resolution specified by an integer. The resolution
          of a fractional number <code class="computeroutput"><span class="identifier">n</span></code>
          is <code class="computeroutput"><span class="number">2</span><span class="special">^</span><span class="identifier">s</span></code>, where <code class="computeroutput"><span class="identifier">s</span></code>
          is the resolution parameter. For example, <code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span></code> has
          values <code class="computeroutput"><span class="identifier">n</span></code> such that <code class="computeroutput"><span class="special">-</span><span class="number">256</span> <span class="special">&lt;</span>
          <span class="identifier">n</span> <span class="special">&lt;</span>
          <span class="number">256</span></code> in increments of <code class="computeroutput"><span class="number">2</span><span class="special">^(-</span><span class="number">4</span><span class="special">)</span> <span class="special">=</span> <span class="number">1</span><span class="special">/</span><span class="number">16</span></code>.
        </p>
<pre class="programlisting"><code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">;</span>
</pre>
<p>
          Both range and resolution parameters may be either positive or negative.
          The number of significant bits or precision is <code class="computeroutput"><span class="identifier">g</span><span class="special">-</span><span class="identifier">s</span></code>. This
          specification enables representing both very small and very large values
          with few bits. In any event, the range must be greater than the resolution,
          that is <code class="computeroutput"><span class="identifier">g</span><span class="special">&gt;</span><span class="identifier">s</span></code>.
        </p>
<pre class="programlisting"><code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;-</span><span class="number">24</span><span class="special">,-</span><span class="number">32</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">;</span> <span class="comment">// small number with a precision of 8 bits </span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.ope"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.ope" title="Initialization from an index">Initialization
        from an index</a>
</h4></div></div></div>
<p>
          By default a fixed point instance is not initialized, so its value is undefined.
        </p>
<p>
          Every fixed point instance can be initialized from the index.
        </p>
<pre class="programlisting"><code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">=</span><span class="identifier">index</span><span class="special">(</span><span class="number">2</span><span class="special">);</span>
</pre>
<p>
          The value represented is <code class="computeroutput"><span class="number">2</span><span class="special">*</span><span class="number">2</span><span class="special">^(-</span><span class="number">4</span><span class="special">)=</span><span class="number">1</span><span class="special">/</span><span class="number">8</span></code>.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.conversions"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.conversions" title="Implicit conversions">Implicit
        conversions</a>
</h4></div></div></div>
<p>
          Implicit conversion is provided between fixed points as far as there is
          no loss of data. Thus, <code class="computeroutput">uint_t</code>
          types will promote to the other types, and the other types will promote
          to <code class="computeroutput"><span class="identifier">fxp_fract</span></code> type. The
          effect is that unsigned fixed-point types promote to signed fixed-point
          types.
        </p>
<pre class="programlisting"><code class="computeroutput">uint_t</code><span class="special">&lt;</span><span class="number">8</span><span class="special">&gt;</span> <span class="identifier">u</span><span class="special">;</span>
<code class="computeroutput">int_t</code><span class="special">&lt;</span><span class="number">8</span><span class="special">&gt;</span> <span class="identifier">i</span><span class="special">=</span><span class="identifier">u</span><span class="special">;</span>
<code class="computeroutput">uint_t</code><span class="special">&lt;</span><span class="number">8</span><span class="special">&gt;</span> <span class="identifier">v</span><span class="special">=</span><span class="identifier">i</span><span class="special">;</span> <span class="comment">// Compile error</span>

<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">;</span>
<code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">b</span><span class="special">=</span><span class="identifier">a</span><span class="special">;</span> <span class="comment">// OK</span>
<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">c</span><span class="special">=</span><span class="identifier">b</span><span class="special">;</span>  <span class="comment">// Compile error</span>

<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">d</span><span class="special">=</span><span class="identifier">i</span><span class="special">;</span> <span class="comment">// OK</span>
<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">e</span><span class="special">=</span><span class="identifier">u</span><span class="special">;</span> <span class="comment">// Compile error</span>
</pre>
<p>
          fixed points types promotes to fixed points types larger range and with
          more precise resolution (i.e. lower).
        </p>
<pre class="programlisting"><code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">;</span>
<code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">9</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">b</span><span class="special">=</span><span class="identifier">a</span><span class="special">;</span> <span class="comment">// OK</span>
<code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">5</span><span class="special">&gt;</span> <span class="identifier">c</span><span class="special">=</span><span class="identifier">a</span><span class="special">;</span> <span class="comment">// OK</span>
<code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">5</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">d</span><span class="special">=</span><span class="identifier">a</span><span class="special">;</span> <span class="comment">// Compile error</span>
<code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">2</span><span class="special">&gt;</span> <span class="identifier">e</span><span class="special">=</span><span class="identifier">a</span><span class="special">;</span> <span class="comment">// Compile error</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.ope0"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.ope0" title="Mixed Arithmetic">Mixed
        Arithmetic</a>
</h4></div></div></div>
<p>
          The basic arithmetic operations are addition, subtraction, multiplication
          and division.
        </p>
<p>
          When mixing operands of different template class types (only allowed for
          mixed arithmetic), implicit fixed point conversion will apply.
        </p>
<pre class="programlisting"><code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">,</span><span class="identifier">b</span><span class="special">;</span>
<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">9</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">c</span><span class="special">=</span><span class="identifier">a</span><span class="special">+</span><span class="identifier">b</span><span class="special">;</span>
<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">9</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">d</span><span class="special">=</span><span class="identifier">a</span><span class="special">-</span><span class="identifier">b</span><span class="special">;</span>
<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">9</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">d</span><span class="special">=</span><span class="identifier">a</span><span class="special">-</span><span class="identifier">b</span><span class="special">;</span>
</pre>
<p>
          There are notable exceptions. Negation and subtraction on unsigned types
          yields a signed type. Comparison across types is direct; there is no conversion
          beforehand.
        </p>
<pre class="programlisting"><code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">a</span><span class="special">;</span>
<code class="computeroutput"><a class="link" href="real_t.html" title="Class template real_t">real_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">b</span><span class="special">=-</span><span class="identifier">a</span><span class="special">;</span> <span class="comment">// OK</span>
<code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code><span class="special">&lt;</span><span class="number">8</span><span class="special">,-</span><span class="number">4</span><span class="special">&gt;</span> <span class="identifier">c</span><span class="special">=-</span><span class="identifier">a</span><span class="special">;</span> <span class="comment">// Compile error</span>
</pre>
<p>
          In general, the range and resolution of the result of basic operations
          are large enough to hold the mathematical results. The following table
          shows the range and resolution for the results of basic operations on fractional
          types. The $ operator returns the range parameter. The @ operator returns
          the resolution parameter.
        </p>
<p>
          Overflow in template argument computation is undefined behavior. In practice,
          overflow is unlikely to be a significant problem because even small machines
          can represent numbers with thousands of bits and because compiler can diagnose
          overflow in template arguments.
        </p>
<p>
          The special case in the operations above is division, where the mathematical
          result may require an infinite number of bits. The actual value must be
          rounded to a representable value. The above resolution is sufficient to
          ensure that if the mathematical result is not zero, the fixed-point result
          is not zero. Furthermore, assuming values have an error of one-half ULP,
          the defined resolution is close to the error bound in the computation.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.round"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.round" title="Rounding">Rounding</a>
</h4></div></div></div>
<p>
          When the computation is not exact, rounding will be to one of the two nearest
          representable values. The algorithm for choosing between these values is
          the rounding mode. Different applications desire different modes, so programmers
          may specify the rounding mode with a round policy class. The provided round
          policy classes are:
        </p>
<p>
          fastest Speed is more important than the choice in value. negative Round
          towards negative infinity. This mode is useful in interval arithmetic.
          truncated Round towards zero. This mode is useful in implementing integral
          arithmetic. positive Round towards positive infinity. This mode is useful
          in interval arithmetic. classic Round towards the nearest value, but exactly-half
          values are rounded towards maximum magnitude. This mode is the standard
          school algorithm. near_even Round towards the nearest value, but exactly-half
          values are rounded towards even values. This mode has more balance than
          the classic mode. near_odd Round towards the nearest value, but exactly-half
          values are rounded towards odd values. This mode has as much balance as
          the near_even mode, but preserves more information.
        </p>
<p>
          In general, these modes get slower but more accurate working down the list.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.overflow"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.overflow" title="Overflow">Overflow</a>
</h4></div></div></div>
<p>
          Since the range of intermediate values grow to hold all possible values,
          and variables have a static range and resolution, construction and assignment
          may need to reduce the range and resolution. Reducing the resolution is
          done with a rounding mode associated with the variable. When the dynamic
          value exceeds the range of variable, the assignment overflows.
        </p>
<p>
          When an overflow does occur, the desirable behavior depends on the application,
          so programmers may specify the overflow mode with an overflow policy. The
          provided overflow policy classes are:
        </p>
<p>
          impossible Programmer analysis of the program has determined that overflow
          cannot occur. Uses of this mode should be accompanied by an argument supporting
          the conclusion. undefined Programmers are willing to accept undefined behavior
          in the event of an overflow. modulus The assigned value is the dynamic
          value mod the range of the variable. This mode makes sense only with unsigned
          numbers. It is useful for angular measures. saturate If the dynamic value
          exceeds the range of the variable, assign the nearest representable value.
          exception If the dynamic value exceeds the range of the variable, throw
          an exception of type std::overflow_error.
        </p>
<p>
          In general, these modes get slower but safer working down the list.
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.literals"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.literals" title="Literals">Literals</a>
</h4></div></div></div>
<p>
          There exists no mechanism in C++11 to specify literals for the template
          types above. However, we can get close with template functions that yield
          the appropriate fixed-point value based on an template int parameter. For
          example, the expression <code class="computeroutput">to_uint_t</code>&lt;24&gt;()
          will produce a <code class="computeroutput">uint_t</code>
          constant with a range just sufficient to hold the value 24. Likewise, the
          expression <code class="computeroutput"><a class="link" href="to_ureal_t.html" title="Function template to_ureal_t">to_ureal_t</a></code>&lt;2884,-4&gt;()
          will produce a <code class="computeroutput"><a class="link" href="ureal_t.html" title="Class template ureal_t">ureal_t</a></code>
          constant with a range and resolution just sufficient to hold the value
          2884*2^(-4).
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family" title="Family">Family</a>
</h4></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.closed">Closed
          arithmetic</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.storage">Storage</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.arth">Open
          versus Closed arithmetic</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.bound">Bounded
          versus unbounded fixed points</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv">Conversions</a></span></dt>
</dl></div>
<div class="section"><div class="titlepage"><div><div><h5 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.closed"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.closed" title="Closed arithmetic">Closed
          arithmetic</a>
</h5></div></div></div></div>
<div class="section"><div class="titlepage"><div><div><h5 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.storage"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.storage" title="Storage">Storage</a>
</h5></div></div></div></div>
<div class="section"><div class="titlepage"><div><div><h5 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.arth"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.arth" title="Open versus Closed arithmetic">Open
          versus Closed arithmetic</a>
</h5></div></div></div></div>
<div class="section"><div class="titlepage"><div><div><h5 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.bound"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.bound" title="Bounded versus unbounded fixed points">Bounded
          versus unbounded fixed points</a>
</h5></div></div></div></div>
<div class="section">
<div class="titlepage"><div><div><h5 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.conv"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv" title="Conversions">Conversions</a>
</h5></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.fp">Conversion
            from floating point</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.builtin">Conversion
            from builtin</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.number_cast">Fixed
            point cast</a></span></dt>
<dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.convert">Forcing
            explicit conversion</a></span></dt>
</dl></div>
<div class="section"><div class="titlepage"><div><div><h6 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.conv.fp"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.fp" title="Conversion from floating point">Conversion
            from floating point</a>
</h6></div></div></div></div>
<div class="section"><div class="titlepage"><div><div><h6 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.conv.builtin"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.builtin" title="Conversion from builtin">Conversion
            from builtin</a>
</h6></div></div></div></div>
<div class="section"><div class="titlepage"><div><div><h6 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.conv.number_cast"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.number_cast" title="Fixed point cast">Fixed
            point cast</a>
</h6></div></div></div></div>
<div class="section"><div class="titlepage"><div><div><h6 class="title">
<a name="boost.fixed_point.users_guide.tutorial.family.conv.convert"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.tutorial.family.conv.convert" title="Forcing explicit conversion">Forcing
            explicit conversion</a>
</h6></div></div></div></div>
</div>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost.fixed_point.users_guide.examples"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.examples" title="Examples">Examples</a>
</h3></div></div></div>
<div class="toc"><dl><dt><span class="section"><a href="users_guide.html#boost.fixed_point.users_guide.examples.alfa">Alfa blending</a></span></dt></dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost.fixed_point.users_guide.examples.alfa"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.examples.alfa" title="Alfa blending">Alfa blending</a>
</h4></div></div></div>
<p>
          Consider the alpha blending of two RGBA pixels, a and b. To avoid redundancy,
          we will only show computation for the red color. The algorithm is somewhat
          complicated by the need to convert the [0-255] range of color representation
          to the [0-1] range of color values.
        </p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">fixed_point</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">fixed_point</span><span class="special">;</span>

<span class="keyword">struct</span> <span class="identifier">pixel</span>
<span class="special">{</span>
  <span class="identifier">ureal_t</span><span class="special">&lt;</span><span class="number">8</span><span class="special">,</span> <span class="number">0</span><span class="special">&gt;</span> <span class="identifier">r</span><span class="special">,</span> <span class="identifier">g</span><span class="special">,</span> <span class="identifier">b</span><span class="special">,</span> <span class="identifier">a</span><span class="special">;</span>
<span class="special">};</span>

<span class="identifier">pixel</span> <span class="identifier">blend</span><span class="special">(</span><span class="identifier">pixel</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">pixel</span> <span class="identifier">b</span><span class="special">)</span>
<span class="special">{</span>
  <span class="identifier">BOOST_AUTO</span><span class="special">(</span><span class="identifier">scale</span><span class="special">,</span> <span class="special">(</span><span class="identifier">to_ureal_t</span><span class="special">&lt;</span><span class="number">255</span><span class="special">,</span> <span class="number">0</span><span class="special">&gt;</span> <span class="special">()));</span>
  <span class="identifier">BOOST_AUTO</span><span class="special">(</span><span class="identifier">a_r</span><span class="special">,</span> <span class="identifier">a</span><span class="special">.</span><span class="identifier">r</span> <span class="special">/</span> <span class="identifier">scale</span><span class="special">);</span>
  <span class="identifier">BOOST_AUTO</span><span class="special">(</span><span class="identifier">b_r</span><span class="special">,</span> <span class="identifier">b</span><span class="special">.</span><span class="identifier">r</span> <span class="special">/</span> <span class="identifier">scale</span><span class="special">);</span>
  <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="identifier">a_r</span><span class="special">;</span>
  <span class="special">(</span><span class="keyword">void</span><span class="special">)</span> <span class="identifier">b_r</span><span class="special">;</span>
  <span class="identifier">BOOST_AUTO</span><span class="special">(</span><span class="identifier">aia</span><span class="special">,</span> <span class="identifier">b</span><span class="special">.</span><span class="identifier">a</span> <span class="special">*</span> <span class="special">(</span><span class="identifier">to_ureal_t</span><span class="special">&lt;</span><span class="number">1</span><span class="special">,</span> <span class="number">0</span><span class="special">&gt;</span> <span class="special">()</span> <span class="special">-</span> <span class="identifier">a</span><span class="special">.</span><span class="identifier">a</span><span class="special">));</span>
  <span class="identifier">BOOST_AUTO</span><span class="special">(</span><span class="identifier">c_a</span><span class="special">,</span> <span class="identifier">a</span><span class="special">.</span><span class="identifier">a</span> <span class="special">+</span> <span class="identifier">aia</span><span class="special">);</span>
  <span class="identifier">BOOST_AUTO</span><span class="special">(</span><span class="identifier">c_r</span><span class="special">,</span> <span class="special">(</span><span class="identifier">a</span><span class="special">.</span><span class="identifier">r</span> <span class="special">*</span> <span class="identifier">a</span><span class="special">.</span><span class="identifier">a</span> <span class="special">+</span> <span class="identifier">b</span><span class="special">.</span><span class="identifier">r</span> <span class="special">*</span> <span class="identifier">aia</span><span class="special">)</span> <span class="special">/</span> <span class="identifier">c_a</span><span class="special">);</span>
  <span class="identifier">pixel</span> <span class="identifier">c</span><span class="special">;</span>
  <span class="identifier">c</span><span class="special">.</span><span class="identifier">a</span> <span class="special">=</span> <span class="identifier">number_cast</span><span class="special">&lt;</span><span class="identifier">ureal_t</span><span class="special">&lt;</span><span class="number">8</span><span class="special">,</span> <span class="number">0</span><span class="special">&gt;</span> <span class="special">&gt;</span> <span class="special">(</span><span class="identifier">c_a</span> <span class="special">*</span> <span class="identifier">to_ureal_t</span><span class="special">&lt;</span><span class="number">255</span><span class="special">,</span> <span class="number">0</span><span class="special">&gt;</span> <span class="special">());</span>
  <span class="identifier">c</span><span class="special">.</span><span class="identifier">r</span> <span class="special">=</span> <span class="identifier">number_cast</span><span class="special">&lt;</span><span class="identifier">ureal_t</span><span class="special">&lt;</span><span class="number">8</span><span class="special">,</span> <span class="number">0</span><span class="special">&gt;</span> <span class="special">&gt;</span> <span class="special">(</span><span class="identifier">c_r</span> <span class="special">*</span> <span class="identifier">to_ureal_t</span><span class="special">&lt;</span><span class="number">255</span><span class="special">,</span> <span class="number">0</span><span class="special">&gt;</span> <span class="special">());</span>
  <span class="keyword">return</span> <span class="identifier">c</span><span class="special">;</span>
<span class="special">}</span>
</pre>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost.fixed_point.users_guide.ext_references"></a><a class="link" href="users_guide.html#boost.fixed_point.users_guide.ext_references" title="External Resources">External
      Resources</a>
</h3></div></div></div>
<div class="variablelist">
<p class="title"><b></b></p>
<dl>
<dt><span class="term"><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3352.html" target="_top"><span class="bold"><strong>N3352 - C++ Binary Fixed-Point Arithmetic</strong></span></a></span></dt>
<dd><p>
              Lawrence Crowl
            </p></dd>
</dl>
</div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2012 Vicente J. Botet Escriba<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="overview.html"><img src="../../images/prev.png" alt="Prev"></a><a accesskey="u" href="../../index.html"><img src="../../images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../images/home.png" alt="Home"></a><a accesskey="n" href="reference.html"><img src="../../images/next.png" alt="Next"></a>
</div>
</body>
</html>
